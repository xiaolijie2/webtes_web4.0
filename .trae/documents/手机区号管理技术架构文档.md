# æ‰‹æœºåŒºå·ç®¡ç†æŠ€æœ¯æ¶æ„æ–‡æ¡£

## 1. æ¶æ„è®¾è®¡

```mermaid
graph TD
    A[ç”¨æˆ·æµè§ˆå™¨] --> B[å‰ç«¯é¡µé¢]
    B --> C[.NET Core Web API]
    C --> D[JSON æ•°æ®æ–‡ä»¶]
    
    subgraph "å‰ç«¯å±‚"
        B1[ç®¡ç†åå°é¡µé¢]
        B2[ç™»å½•é¡µé¢]
        B3[æ³¨å†Œé¡µé¢]
        B4[åŒºå·é€‰æ‹©ç»„ä»¶]
    end
    
    subgraph "åç«¯å±‚"
        C1[CountryCodeController]
        C2[æ•°æ®æœåŠ¡å±‚]
    end
    
    subgraph "æ•°æ®å±‚"
        D1[country_codes.json]
    end
    
    B --> B1
    B --> B2
    B --> B3
    B2 --> B4
    B3 --> B4
    C --> C1
    C1 --> C2
    C2 --> D1
```

## 2. æŠ€æœ¯æè¿°

- å‰ç«¯ï¼šåŸç”Ÿ HTML + CSS + JavaScript
- åç«¯ï¼š.NET Core 6.0 Web API
- æ•°æ®å­˜å‚¨ï¼šJSON æ–‡ä»¶
- UI æ¡†æ¶ï¼šBootstrap 5 + Font Awesome å›¾æ ‡

## 3. è·¯ç”±å®šä¹‰

| è·¯ç”± | ç”¨é€” |
|------|------|
| /admin.html#website | åå°ç½‘ç«™è®¾ç½®é¡µé¢ï¼ŒåŒ…å«åŒºå·ç®¡ç†åŠŸèƒ½ |
| /login.html | ç™»å½•é¡µé¢ï¼Œé›†æˆåŒºå·é€‰æ‹©ç»„ä»¶ |
| /register.html | æ³¨å†Œé¡µé¢ï¼Œé›†æˆåŒºå·é€‰æ‹©ç»„ä»¶ |

## 4. API å®šä¹‰

### 4.1 æ ¸å¿ƒ API

**è·å–åŒºå·è®¾ç½®**
```
GET /api/admin/country-codes
```

å“åº”ï¼š
| å‚æ•°åç§° | å‚æ•°ç±»å‹ | æè¿° |
|----------|----------|------|
| success | boolean | è¯·æ±‚æ˜¯å¦æˆåŠŸ |
| data | array | åŒºå·æ•°æ®æ•°ç»„ |

ç¤ºä¾‹å“åº”ï¼š
```json
{
  "success": true,
  "data": [
    {
      "id": "US",
      "countryName": "ç¾å›½",
      "countryCode": "+1",
      "flag": "ğŸ‡ºğŸ‡¸",
      "enabled": true,
      "isDefault": true,
      "sortOrder": 1
    }
  ]
}
```

**æ›´æ–°åŒºå·è®¾ç½®**
```
POST /api/admin/country-codes
```

è¯·æ±‚ï¼š
| å‚æ•°åç§° | å‚æ•°ç±»å‹ | æ˜¯å¦å¿…éœ€ | æè¿° |
|----------|----------|----------|------|
| countryCodes | array | true | åŒºå·è®¾ç½®æ•°ç»„ |

**è·å–å¯ç”¨çš„åŒºå·åˆ—è¡¨ï¼ˆå‰ç«¯è°ƒç”¨ï¼‰**
```
GET /api/country-codes
```

å“åº”ï¼š
| å‚æ•°åç§° | å‚æ•°ç±»å‹ | æè¿° |
|----------|----------|------|
| success | boolean | è¯·æ±‚æ˜¯å¦æˆåŠŸ |
| data | array | å¯ç”¨çš„åŒºå·æ•°æ®æ•°ç»„ |
| defaultCode | string | é»˜è®¤åŒºå· |

## 5. æœåŠ¡å™¨æ¶æ„å›¾

```mermaid
graph TD
    A[HTTP è¯·æ±‚] --> B[è·¯ç”±ä¸­é—´ä»¶]
    B --> C[CountryCodeController]
    C --> D[ä¸šåŠ¡é€»è¾‘å±‚]
    D --> E[æ•°æ®è®¿é—®å±‚]
    E --> F[JSON æ–‡ä»¶å­˜å‚¨]
    
    subgraph "æ§åˆ¶å™¨å±‚"
        C
    end
    
    subgraph "æœåŠ¡å±‚"
        D
    end
    
    subgraph "æ•°æ®å±‚"
        E
        F
    end
```

## 6. æ•°æ®æ¨¡å‹

### 6.1 æ•°æ®æ¨¡å‹å®šä¹‰

```mermaid
erDiagram
    COUNTRY_CODE {
        string id PK
        string countryName
        string countryCode
        string flag
        boolean enabled
        boolean isDefault
        int sortOrder
        datetime createdAt
        datetime updatedAt
    }
```

### 6.2 æ•°æ®å®šä¹‰è¯­è¨€

**åŒºå·æ•°æ®æ–‡ä»¶ (country_codes.json)**
```json
{
  "countryCodes": [
    {
      "id": "US",
      "countryName": "ç¾å›½",
      "countryCode": "+1",
      "flag": "ğŸ‡ºğŸ‡¸",
      "enabled": true,
      "isDefault": true,
      "sortOrder": 1,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "JP",
      "countryName": "æ—¥æœ¬",
      "countryCode": "+81",
      "flag": "ğŸ‡¯ğŸ‡µ",
      "enabled": true,
      "isDefault": false,
      "sortOrder": 2,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "DE",
      "countryName": "å¾·å›½",
      "countryCode": "+49",
      "flag": "ğŸ‡©ğŸ‡ª",
      "enabled": true,
      "isDefault": false,
      "sortOrder": 3,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "GB",
      "countryName": "è‹±å›½",
      "countryCode": "+44",
      "flag": "ğŸ‡¬ğŸ‡§",
      "enabled": true,
      "isDefault": false,
      "sortOrder": 4,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "FR",
      "countryName": "æ³•å›½",
      "countryCode": "+33",
      "flag": "ğŸ‡«ğŸ‡·",
      "enabled": true,
      "isDefault": false,
      "sortOrder": 5,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "CA",
      "countryName": "åŠ æ‹¿å¤§",
      "countryCode": "+1",
      "flag": "ğŸ‡¨ğŸ‡¦",
      "enabled": true,
      "isDefault": false,
      "sortOrder": 6,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "AU",
      "countryName": "æ¾³å¤§åˆ©äºš",
      "countryCode": "+61",
      "flag": "ğŸ‡¦ğŸ‡º",
      "enabled": true,
      "isDefault": false,
      "sortOrder": 7,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "KR",
      "countryName": "éŸ©å›½",
      "countryCode": "+82",
      "flag": "ğŸ‡°ğŸ‡·",
      "enabled": true,
      "isDefault": false,
      "sortOrder": 8,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "IT",
      "countryName": "æ„å¤§åˆ©",
      "countryCode": "+39",
      "flag": "ğŸ‡®ğŸ‡¹",
      "enabled": true,
      "isDefault": false,
      "sortOrder": 9,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "ES",
      "countryName": "è¥¿ç­ç‰™",
      "countryCode": "+34",
      "flag": "ğŸ‡ªğŸ‡¸",
      "enabled": true,
      "isDefault": false,
      "sortOrder": 10,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "NL",
      "countryName": "è·å…°",
      "countryCode": "+31",
      "flag": "ğŸ‡³ğŸ‡±",
      "enabled": false,
      "isDefault": false,
      "sortOrder": 11,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "CH",
      "countryName": "ç‘å£«",
      "countryCode": "+41",
      "flag": "ğŸ‡¨ğŸ‡­",
      "enabled": false,
      "isDefault": false,
      "sortOrder": 12,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "SE",
      "countryName": "ç‘å…¸",
      "countryCode": "+46",
      "flag": "ğŸ‡¸ğŸ‡ª",
      "enabled": false,
      "isDefault": false,
      "sortOrder": 13,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "NO",
      "countryName": "æŒªå¨",
      "countryCode": "+47",
      "flag": "ğŸ‡³ğŸ‡´",
      "enabled": false,
      "isDefault": false,
      "sortOrder": 14,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "DK",
      "countryName": "ä¸¹éº¦",
      "countryCode": "+45",
      "flag": "ğŸ‡©ğŸ‡°",
      "enabled": false,
      "isDefault": false,
      "sortOrder": 15,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "FI",
      "countryName": "èŠ¬å…°",
      "countryCode": "+358",
      "flag": "ğŸ‡«ğŸ‡®",
      "enabled": false,
      "isDefault": false,
      "sortOrder": 16,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "BE",
      "countryName": "æ¯”åˆ©æ—¶",
      "countryCode": "+32",
      "flag": "ğŸ‡§ğŸ‡ª",
      "enabled": false,
      "isDefault": false,
      "sortOrder": 17,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "AT",
      "countryName": "å¥¥åœ°åˆ©",
      "countryCode": "+43",
      "flag": "ğŸ‡¦ğŸ‡¹",
      "enabled": false,
      "isDefault": false,
      "sortOrder": 18,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "NZ",
      "countryName": "æ–°è¥¿å…°",
      "countryCode": "+64",
      "flag": "ğŸ‡³ğŸ‡¿",
      "enabled": false,
      "isDefault": false,
      "sortOrder": 19,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    },
    {
      "id": "SG",
      "countryName": "æ–°åŠ å¡",
      "countryCode": "+65",
      "flag": "ğŸ‡¸ğŸ‡¬",
      "enabled": false,
      "isDefault": false,
      "sortOrder": 20,
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-01T00:00:00Z"
    }
  ],
  "lastUpdated": "2024-01-01T00:00:00Z"
}
```

## 7. å‰ç«¯ç»„ä»¶è®¾è®¡

### 7.1 åŒºå·é€‰æ‹©ç»„ä»¶ (CountryCodeSelector)

**åŠŸèƒ½ç‰¹æ€§ï¼š**
- ä¸‹æ‹‰æŠ½å±‰å¼ç•Œé¢
- æ˜¾ç¤ºå›½æ——ã€å›½å®¶åç§°å’ŒåŒºå·
- æ”¯æŒæœç´¢è¿‡æ»¤
- é»˜è®¤é€‰ä¸­é…ç½®çš„é»˜è®¤åŒºå·
- å“åº”å¼è®¾è®¡ï¼Œç§»åŠ¨ç«¯å‹å¥½

**ç»„ä»¶æ¥å£ï¼š**
```javascript
// åˆå§‹åŒ–åŒºå·é€‰æ‹©å™¨
function initCountryCodeSelector(containerId, options) {
  // containerId: å®¹å™¨å…ƒç´ ID
  // options: é…ç½®é€‰é¡¹
  //   - onSelect: é€‰æ‹©å›è°ƒå‡½æ•°
  //   - placeholder: å ä½ç¬¦æ–‡æœ¬
  //   - showSearch: æ˜¯å¦æ˜¾ç¤ºæœç´¢æ¡†
}

// è·å–é€‰ä¸­çš„åŒºå·
function getSelectedCountryCode(selectorId) {
  // è¿”å›é€‰ä¸­çš„åŒºå·å¯¹è±¡
}

// è®¾ç½®é»˜è®¤é€‰ä¸­åŒºå·
function setDefaultCountryCode(selectorId, countryId) {
  // è®¾ç½®æŒ‡å®šåŒºå·ä¸ºé€‰ä¸­çŠ¶æ€
}
```

### 7.2 åå°ç®¡ç†ç•Œé¢

**åŠŸèƒ½æ¨¡å—ï¼š**
- åŒºå·åˆ—è¡¨å±•ç¤ºï¼ˆè¡¨æ ¼å½¢å¼ï¼‰
- å¯ç”¨/ç¦ç”¨å¼€å…³æ§ä»¶
- é»˜è®¤åŒºå·å•é€‰æ§ä»¶
- æ‰¹é‡æ“ä½œåŠŸèƒ½
- ä¿å­˜å’Œé‡ç½®æŒ‰é’®

**æ•°æ®ç»‘å®šï¼š**
- å®æ—¶åŒæ­¥å‰ç«¯çŠ¶æ€ä¸åç«¯æ•°æ®
- è¡¨å•éªŒè¯ï¼ˆç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ªå¯ç”¨çš„åŒºå·ï¼‰
- è‡ªåŠ¨ä¿å­˜åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰